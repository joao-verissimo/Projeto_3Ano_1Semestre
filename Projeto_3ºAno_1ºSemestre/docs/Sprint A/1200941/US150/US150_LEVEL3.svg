<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1202px" preserveAspectRatio="none" style="width:2497px;height:1202px;background:#FFFFFF;" version="1.1" viewBox="0 0 2497 1202" width="2497px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="1087.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="365.5" y="69.9609"/><rect fill="#FFFFFF" height="1056.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="699.5" y="100.3125"/><rect fill="#FFFFFF" height="982.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="935.5" y="175.0156"/><rect fill="#FFFFFF" height="951" style="stroke:#181818;stroke-width:1.0;" width="10" x="1201.5" y="205.3672"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1414.5" y="235.7188"/><rect fill="#FFFFFF" height="212.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="1414.5" y="554.3672"/><rect fill="#FFFFFF" height="86.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1593.5" y="266.0703"/><rect fill="#FFFFFF" height="151.7578" style="stroke:#181818;stroke-width:1.0;" width="10" x="1593.5" y="584.7188"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1791.5" y="615.0703"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1791.5" y="797.1797"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1902" y="468.3125"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="2002.5" y="130.6641"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="2122" y="280.0703"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="2271.5" y="294.0703"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2408" y="675.7734"/><rect fill="none" height="612.3516" style="stroke:#000000;stroke-width:1.5;" width="1869" x="621.5" y="367.4219"/><rect fill="none" height="459.1094" style="stroke:#000000;stroke-width:1.5;" width="1849" x="631.5" y="513.6641"/><rect fill="none" height="155.5938" style="stroke:#000000;stroke-width:1.5;" width="767.5" x="10" y="993.7734"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="41" x2="41" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="370" x2="370" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="704.5" x2="704.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="940" x2="940" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1206.5" x2="1206.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1419.5" x2="1419.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1598" x2="1598" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1796.5" x2="1796.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1906.5" x2="1906.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2007.5" x2="2007.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2126.5" x2="2126.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2276.5" x2="2276.5" y1="37.6094" y2="1166.3672"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2412.5" x2="2412.5" y1="37.6094" y2="1166.3672"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43" x="20" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="27" y="26.5332">User</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43" x="20" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="27" y="1186.9004">User</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="306" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="313" y="26.5332">IBuildingController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="306" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="313" y="1186.9004">IBuildingController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="641.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="648.5" y="26.5332">BuildingController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="641.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="648.5" y="1186.9004">BuildingController</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="880" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="887" y="26.5332">IBuildingsService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="880" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="887" y="1186.9004">IBuildingsService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1147.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1154.5" y="26.5332">BuildingsService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1147.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1154.5" y="1186.9004">BuildingsService</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108" x="1365.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="1372.5" y="26.5332">IBuildingsRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108" x="1365.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="1372.5" y="1186.9004">IBuildingsRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="1546" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1553" y="26.5332">BuildingsRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="1546" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1553" y="1186.9004">BuildingsRepo</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1747.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1754.5" y="26.5332">BuildingsMap</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1747.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1754.5" y="1186.9004">BuildingsMap</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="1855.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="1862.5" y="26.5332">Building Entity</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="1855.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="1862.5" y="1186.9004">Building Entity</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="1968.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1975.5" y="26.5332">ConfigFile</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78" x="1968.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="1975.5" y="1186.9004">ConfigFile</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="2056.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="2063.5" y="26.5332">IBuildingPersistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="2056.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="2063.5" y="1186.9004">IBuildingPersistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="2207.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="2214.5" y="26.5332">BuildingPersistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="2207.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="2214.5" y="1186.9004">BuildingPersistence</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="2355.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="2362.5" y="26.5332">BuildingSchema</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="2355.5" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="2362.5" y="1186.9004">BuildingSchema</text><rect fill="#FFFFFF" height="1087.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="365.5" y="69.9609"/><rect fill="#FFFFFF" height="1056.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="699.5" y="100.3125"/><rect fill="#FFFFFF" height="982.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="935.5" y="175.0156"/><rect fill="#FFFFFF" height="951" style="stroke:#181818;stroke-width:1.0;" width="10" x="1201.5" y="205.3672"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1414.5" y="235.7188"/><rect fill="#FFFFFF" height="212.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="1414.5" y="554.3672"/><rect fill="#FFFFFF" height="86.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1593.5" y="266.0703"/><rect fill="#FFFFFF" height="151.7578" style="stroke:#181818;stroke-width:1.0;" width="10" x="1593.5" y="584.7188"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1791.5" y="615.0703"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1791.5" y="797.1797"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="1902" y="468.3125"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="2002.5" y="130.6641"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="2122" y="280.0703"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="2271.5" y="294.0703"/><rect fill="#FFFFFF" height="30.3516" style="stroke:#181818;stroke-width:1.0;" width="10" x="2408" y="675.7734"/><polygon fill="#181818" points="353.5,65.9609,363.5,69.9609,353.5,73.9609,357.5,69.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.5" x2="359.5" y1="69.9609" y2="69.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="48.5" y="65.1045">send request to createBuilding(req, res, next)</text><polygon fill="#181818" points="687.5,96.3125,697.5,100.3125,687.5,104.3125,691.5,100.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="375.5" x2="693.5" y1="100.3125" y2="100.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="382.5" y="95.4561">createBuilding(req, res, next)</text><polygon fill="#181818" points="1990.5,126.6641,2000.5,130.6641,1990.5,134.6641,1994.5,130.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="709.5" x2="1996.5" y1="130.6641" y2="130.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="716.5" y="125.8076">Injects Service</text><polygon fill="#181818" points="720.5,140.6641,710.5,144.6641,720.5,148.6641,716.5,144.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="714.5" x2="2006.5" y1="144.6641" y2="144.6641"/><polygon fill="#181818" points="923.5,171.0156,933.5,175.0156,923.5,179.0156,927.5,175.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="709.5" x2="929.5" y1="175.0156" y2="175.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="716.5" y="170.1592">createBuilding(req, res, next)</text><polygon fill="#181818" points="1189.5,201.3672,1199.5,205.3672,1189.5,209.3672,1193.5,205.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="945.5" x2="1195.5" y1="205.3672" y2="205.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="952.5" y="200.5107">createBuilding(req.body as IBuildingDTO)</text><polygon fill="#181818" points="1402.5,231.7188,1412.5,235.7188,1402.5,239.7188,1406.5,235.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1211.5" x2="1408.5" y1="235.7188" y2="235.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="1218.5" y="230.8623">findByName(buildingDTO.name)</text><polygon fill="#181818" points="1581.5,262.0703,1591.5,266.0703,1581.5,270.0703,1585.5,266.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1419.5" x2="1587.5" y1="266.0703" y2="266.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="1426.5" y="261.2139">buildingDocument (or null)</text><polygon fill="#181818" points="2110,276.0703,2120,280.0703,2110,284.0703,2114,280.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1603.5" x2="2116" y1="280.0703" y2="280.0703"/><polygon fill="#181818" points="2259.5,290.0703,2269.5,294.0703,2259.5,298.0703,2263.5,294.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2132" x2="2265.5" y1="294.0703" y2="294.0703"/><polygon fill="#181818" points="2143,304.0703,2133,308.0703,2143,312.0703,2139,308.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2137" x2="2275.5" y1="308.0703" y2="308.0703"/><polygon fill="#181818" points="1614.5,318.0703,1604.5,322.0703,1614.5,326.0703,1610.5,322.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1608.5" x2="2126" y1="322.0703" y2="322.0703"/><polygon fill="#181818" points="1222.5,348.4219,1212.5,352.4219,1222.5,356.4219,1218.5,352.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1216.5" x2="1597.5" y1="352.4219" y2="352.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="1228.5" y="347.5654">buildingDocument (or null)</text><path d="M621.5,367.4219 L682.5,367.4219 L682.5,375.7734 L672.5,385.7734 L621.5,385.7734 L621.5,367.4219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="612.3516" style="stroke:#000000;stroke-width:1.5;" width="1869" x="621.5" y="367.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="636.5" y="381.917">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="203" x="697.5" y="380.8408">[building with the same name found]</text><polygon fill="#181818" points="720.5,404.125,710.5,408.125,720.5,412.125,716.5,408.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="714.5" x2="1200.5" y1="408.125" y2="408.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="726.5" y="403.2686">Return failure Result</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="621.5" x2="2490.5" y1="417.125" y2="417.125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="100" x="626.5" y="428.5439">[building creation]</text><polygon fill="#181818" points="1784.5,450.3125,1794.5,454.3125,1784.5,458.3125,1788.5,454.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1211.5" x2="1790.5" y1="454.3125" y2="454.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="1218.5" y="449.4561">ToDomain(req.body as IBuildingDTO)</text><polygon fill="#181818" points="1890,464.3125,1900,468.3125,1890,472.3125,1894,468.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1796.5" x2="1896" y1="468.3125" y2="468.3125"/><polygon fill="#181818" points="1222.5,494.6641,1212.5,498.6641,1222.5,502.6641,1218.5,498.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1216.5" x2="1906" y1="498.6641" y2="498.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="1228.5" y="493.8076">buildingOrError</text><path d="M631.5,513.6641 L692.5,513.6641 L692.5,522.0156 L682.5,532.0156 L631.5,532.0156 L631.5,513.6641 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="459.1094" style="stroke:#000000;stroke-width:1.5;" width="1849" x="631.5" y="513.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="646.5" y="528.1592">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="164" x="707.5" y="527.083">[building creation successful]</text><polygon fill="#181818" points="1402.5,550.3672,1412.5,554.3672,1402.5,558.3672,1406.5,554.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1211.5" x2="1408.5" y1="554.3672" y2="554.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="1218.5" y="549.5107">save(buildingResult)</text><polygon fill="#181818" points="1581.5,580.7188,1591.5,584.7188,1581.5,588.7188,1585.5,584.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1424.5" x2="1587.5" y1="584.7188" y2="584.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="1431.5" y="579.8623">save(buildingResult)</text><polygon fill="#181818" points="1779.5,611.0703,1789.5,615.0703,1779.5,619.0703,1783.5,615.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1603.5" x2="1785.5" y1="615.0703" y2="615.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="1610.5" y="610.2139">toPersistence(buildingResult)</text><polygon fill="#181818" points="1614.5,641.4219,1604.5,645.4219,1614.5,649.4219,1610.5,645.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1608.5" x2="1795.5" y1="645.4219" y2="645.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="1620.5" y="640.5654">return rawBuilding</text><polygon fill="#181818" points="2396,671.7734,2406,675.7734,2396,679.7734,2400,675.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1603.5" x2="2402" y1="675.7734" y2="675.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="1610.5" y="670.917">create(rawBuilding)</text><polygon fill="#181818" points="1614.5,702.125,1604.5,706.125,1614.5,710.125,1610.5,706.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1608.5" x2="2412" y1="706.125" y2="706.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1620.5" y="701.2686">return buildingDocument</text><polygon fill="#181818" points="1435.5,732.4766,1425.5,736.4766,1435.5,740.4766,1431.5,736.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1429.5" x2="1597.5" y1="736.4766" y2="736.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1441.5" y="731.6201">saved buildingDocument</text><polygon fill="#181818" points="1222.5,762.8281,1212.5,766.8281,1222.5,770.8281,1218.5,766.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1216.5" x2="1418.5" y1="766.8281" y2="766.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1228.5" y="761.9717">saved buildingDocument</text><polygon fill="#181818" points="1779.5,793.1797,1789.5,797.1797,1779.5,801.1797,1783.5,797.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1211.5" x2="1785.5" y1="797.1797" y2="797.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="1218.5" y="792.3232">toDTO(buildingResult)</text><polygon fill="#181818" points="1222.5,823.5313,1212.5,827.5313,1222.5,831.5313,1218.5,827.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1216.5" x2="1795.5" y1="827.5313" y2="827.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="1228.5" y="822.6748">buildingDTOResult</text><polygon fill="#181818" points="956.5,853.8828,946.5,857.8828,956.5,861.8828,952.5,857.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="950.5" x2="1200.5" y1="857.8828" y2="857.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="962.5" y="853.0264">buildingDTOResult</text><polygon fill="#181818" points="720.5,884.2344,710.5,888.2344,720.5,892.2344,716.5,888.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="714.5" x2="934.5" y1="888.2344" y2="888.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="726.5" y="883.3779">Return successful Result with DTO</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="631.5" x2="2480.5" y1="897.2344" y2="897.2344"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="133" x="636.5" y="908.6533">[building creation failed]</text><polygon fill="#181818" points="956.5,930.4219,946.5,934.4219,956.5,938.4219,952.5,934.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="950.5" x2="1200.5" y1="934.4219" y2="934.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="962.5" y="929.5654">Error Result</text><polygon fill="#181818" points="720.5,960.7734,710.5,964.7734,720.5,968.7734,716.5,964.7734" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="714.5" x2="934.5" y1="964.7734" y2="964.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="726.5" y="959.917">Error Result</text><path d="M10,993.7734 L71,993.7734 L71,1002.125 L61,1012.125 L10,1012.125 L10,993.7734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.5938" style="stroke:#000000;stroke-width:1.5;" width="767.5" x="10" y="993.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="1008.2686">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="230" x="86" y="1007.1924">[BuildingsService returns a failure Result]</text><polygon fill="#181818" points="386.5,1030.4766,376.5,1034.4766,386.5,1038.4766,382.5,1034.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="380.5" x2="698.5" y1="1034.4766" y2="1034.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="392.5" y="1029.6201">Send response with status 402</text><polygon fill="#181818" points="52.5,1060.8281,42.5,1064.8281,52.5,1068.8281,48.5,1064.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.5" x2="364.5" y1="1064.8281" y2="1064.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="58.5" y="1059.9717">Send response with status 402</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="777.5" y1="1073.8281" y2="1073.8281"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="256" x="15" y="1085.2471">[BuildingsService returns a successful Result]</text><polygon fill="#181818" points="386.5,1107.0156,376.5,1111.0156,386.5,1115.0156,382.5,1111.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="380.5" x2="698.5" y1="1111.0156" y2="1111.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="392.5" y="1106.1592">Send response with status 201 and the buildingDTO</text><polygon fill="#181818" points="52.5,1137.3672,42.5,1141.3672,52.5,1145.3672,48.5,1141.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.5" x2="364.5" y1="1141.3672" y2="1141.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="58.5" y="1136.5107">Send response with status 201 and the buildingDTO</text><!--MD5=[11012605aef312fdda4c440f893a47e5]
@startuml sd

participant "User" as A
participant "IBuildingController" as IB
participant "BuildingController" as B
participant "IBuildingsService" as IC
participant "BuildingsService" as C
participant "IBuildingsRepo" as ID
participant "BuildingsRepo" as D
participant "BuildingsMap" as F
participant "Building Entity" as E
participant "ConfigFile" as CONF
participant "IBuildingPersistence" as IH
participant "BuildingPersistence" as H
participant "BuildingSchema" as I

A -> IB: send request to createBuilding(req, res, next)
activate IB
IB -> B:createBuilding(req, res, next)
activate B
B -> CONF : Injects Service
activate CONF

CONF -> B
deactivate CONF

B -> IC: createBuilding(req, res, next)
activate IC

IC -> C: createBuilding(req.body as IBuildingDTO)
activate C

C -> ID: findByName(buildingDTO.name)
activate ID

ID -> D: buildingDocument (or null)
deactivate ID
activate D
D - -> IH: 
activate IH
IH - -> H: 
activate H
H - -> IH: 
deactivate H
IH - -> D
deactivate IH
D - -> C: buildingDocument (or null)
deactivate D

alt building with the same name found
    C - -> B: Return failure Result
else building creation
    C -> F: ToDomain(req.body as IBuildingDTO)
    F -> E:
    activate E
    E - -> C: buildingOrError
    deactivate E
    
    alt building creation successful
        C -> ID: save(buildingResult)
        activate ID
        ID -> D: save(buildingResult)
        activate D
        D -> F: toPersistence(buildingResult)
        activate F 
        F - -> D : return rawBuilding
        deactivate F
        D - -> I: create(rawBuilding)
        activate I
        I - -> D : return buildingDocument
        deactivate I
        D - -> ID: saved buildingDocument
        deactivate D
        ID - -> C: saved buildingDocument
        deactivate ID
        
        C -> F: toDTO(buildingResult)
        activate F
        F - -> C: buildingDTOResult
        deactivate F
        C - -> IC : buildingDTOResult
        IC - -> B: Return successful Result with DTO
    else building creation failed
        C - -> IC: Error Result
        IC - -> B: Error Result
    end
end

alt BuildingsService returns a failure Result
    B -> IB: Send response with status 402
    IB -> A: Send response with status 402
else BuildingsService returns a successful Result
    B -> IB: Send response with status 201 and the buildingDTO
    IB -> A: Send response with status 201 and the buildingDTO

end

deactivate C
deactivate B

@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 WEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>